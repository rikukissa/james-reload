var server;server=function(e){var r,t,n,o,i,u,a,s;return i=require("fs"),u=require("http"),r=require("websocket").server,n=i.readFileSync(__dirname+"/client.js"),t=function(e){return e.replace("</body>","<script>"+(""+n)+"</script></body>")},server=u.createServer(function(r,n){var o;return o=u.request({hostname:"localhost",port:e.proxy,method:r.method,path:r.url,headers:r.headers},function(e){var r,o,i;return o=e.headers["content-type"],i=null!=o&&o.indexOf("text/html")>-1,r="",e.on("data",function(e){return i?r+=e:n.write(e,"binary")}),e.on("end",function(){return i?n.end(t(r),"binary"):n.end()}),i?void 0:n.writeHead(e.statusCode,e.headers)}),o.end()}),server.listen(e.reload),s=new r({httpServer:server,autoAcceptConnections:!1}),o=[],s.on("request",function(e){var r;return r=e.accept(null,e.origin),o.push(r),r.on("close",function(){return o.splice(o.indexOf(r),1)})}),a=function(e){var r,t,n,i;for(null==e&&(e=!1),i=[],t=0,n=o.length;n>t;t++)r=o[t],i.push(r.sendUTF(e?"refresh":"reload"));return i}},module.exports=server;